#include <msp430.h>
#define WAIT_CYCLES 100000 // magic number. „тобы перестало им быть , нужно узнать MCLK
// https://stackoverflow.com/questions/34258254/msp430-delay-cycles-is-slow-mclk-might-be-slow
volatile long int i = 0;
volatile char bState = 0;
void main(void)
{
    // stop wd
    WDTCTL = WDTPW | WDTHOLD;

    // S1 input
    P1DIR &= ~BIT7;
    // pull enable
    P1REN |= BIT7;
    //pull-up
    P1OUT |= BIT7;

    //led 1 on p1.1
    //out
    P1DIR |= BIT1;
    //en
    P1OUT |= BIT1;

    //led 2 on 1.5
    //out
    P1DIR |=BIT5;
    //en
    P1OUT |=BIT5;
    while(1)
    {
        //bState = !(P1IN & BIT7);
        for (i=0; i<WAIT_CYCLES; i++){
            bState = !(P1IN & BIT7);
            if (!bState){
                P1OUT&=~BIT1;
                P1OUT&=~BIT5;
            }
            else {
                P1OUT|=BIT1;
            }
            ;
        }
        P1OUT^=BIT1;
        for (i=0; i<WAIT_CYCLES; i++){
            bState = !(P1IN & BIT7);
            if (!bState){
                            P1OUT&=~BIT1;
                            P1OUT&=~BIT5;
                        }
            else {
                P1OUT|=BIT5;
            }
        }
        P1OUT^=BIT5;
    }
}
